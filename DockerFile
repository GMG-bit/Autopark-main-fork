# Última prueba de integridad de archivo# ----------------------------------------
# 1. ETAPA BASE: Configuración del entorno Python
# ----------------------------------------
FROM python:3.9-slim

# Establece variables de entorno para evitar problemas de caché de Python
ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1

# Crea y establece el directorio de trabajo dentro del contenedor
WORKDIR /usr/src/app

# ----------------------------------------
# 2. DEPENDENCIAS
# ----------------------------------------
# Copia el archivo de requisitos
COPY requirements.txt /usr/src/app/

# Instala las dependencias del proyecto
# Usamos 'no-cache-dir' para reducir el tamaño de la imagen
RUN pip install --no-cache-dir -r requirements.txt

# ----------------------------------------
# 3. CÓDIGO DE LA APLICACIÓN
# ----------------------------------------
# Copia todo el código de la aplicación (incluye el backend, frontend, etc.)
COPY . /usr/src/app/

# ----------------------------------------
# 4. CONFIGURACIÓN FINAL Y EJECUCIÓN
# ----------------------------------------
# Expone el puerto por defecto de Django
EXPOSE 8000

# Comando para iniciar el servidor
# La aplicación Django suele estar en la carpeta 'backend', ajusta si es necesario
CMD ["python", "backend/manage.py", "runserver", "0.0.0.0:8000"]